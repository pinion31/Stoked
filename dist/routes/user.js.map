{"version":3,"sources":["../../server/routes/user.js"],"names":["express","require","router","Router","User","post","req","res","findOneAndUpdate","profileId","body","name","description","profilePic","new","then","status","json","user","catch","err","console","log","session","passport","findOne","save","toObject","error","get","find","lean","$ne","users","module","exports"],"mappings":"AAAA;;AAEA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,SAASF,QAAQG,MAAR,EAAf;AACA,IAAMC,OAAOH,QAAQ,gBAAR,CAAb;;AAGA;;;;;AAKAC,OAAOG,IAAP,CAAY,UAAZ,EAAwB,UAACC,GAAD,EAAKC,GAAL,EAAa;AACnCH,OAAKI,gBAAL,CAAsB,EAACC,WAAWH,IAAII,IAAJ,CAASD,SAArB,EAAtB,EAAuD;AACrDE,UAAML,IAAII,IAAJ,CAASC,IADsC;AAErDC,iBAAaN,IAAII,IAAJ,CAASE,WAF+B;AAGrDC,gBAAYP,IAAII,IAAJ,CAASG;AAHgC,GAAvD,EAKA;AACEC,SAAI;AADN,GALA,EAOGC,IAPH,CAOQ,gBAAQ;AACdR,QAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBC,IAArB;AACD,GATD,EASGC,KATH,CASS,eAAO;AACd,UAAMC,GAAN;AACD,GAXD;AAYD,CAbD;;AAeA;;;;;AAKAlB,OAAOG,IAAP,CAAY,WAAZ,EAAyB,UAACC,GAAD,EAAKC,GAAL,EAAa;AACpCc,UAAQC,GAAR,CAAYhB,IAAIiB,OAAJ,CAAYC,QAAZ,CAAqBN,IAArB,CAA0BT,SAAtC;AACAL,OAAKqB,OAAL,CAAa,EAAChB,WAAWH,IAAIiB,OAAJ,CAAYC,QAAZ,CAAqBN,IAArB,CAA0BT,SAAtC,EAAb,EACGM,IADH,CACQ,gBAAQ;AACZ,QAAIG,IAAJ,EAAU;AACRA,WAAKP,IAAL,GAAYL,IAAII,IAAJ,CAASC,IAArB;AACAO,WAAKN,WAAL,GAAmBN,IAAII,IAAJ,CAASE,WAA5B;AACAM,WAAKL,UAAL,GAAkBP,IAAII,IAAJ,CAASG,UAA3B;AACAK,WAAKQ,IAAL;AACAnB,UAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBC,KAAKS,QAAL,EAArB;AACD,KAND,MAMO;AACLpB,UAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACW,OAAO,gBAAR,EAArB;AACD;AACF,GAXH;AAYD,CAdD;;AAiBA;;;;AAIA1B,OAAO2B,GAAP,CAAW,UAAX,EAAuB,UAACvB,GAAD,EAAKC,GAAL,EAAa;AAClCH,OAAK0B,IAAL,CAAU,EAACrB,WAAWH,IAAIiB,OAAJ,CAAYC,QAAZ,CAAqBN,IAArB,CAA0BT,SAAtC,EAAV,EAA4DsB,IAA5D,GACGhB,IADH,CACQ,gBAAQ;AACZR,QAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBC,KAAK,CAAL,CAArB;AACD,GAHH,EAGKC,KAHL,CAGW,eAAO;AACd,QAAIC,GAAJ,EAAS;AACP,YAAMA,GAAN;AACD;AACF,GAPH;AAQD,CATD;;AAWA;;;;;;AAMAlB,OAAO2B,GAAP,CAAW,cAAX,EAA2B,UAACvB,GAAD,EAAKC,GAAL,EAAa;AACtCH,OAAK0B,IAAL,CAAU,EAAC,aAAa,EAACE,KAAK1B,IAAIiB,OAAJ,CAAYC,QAAZ,CAAqBN,IAArB,CAA0BT,SAAhC,EAAd,EAAV,EAAqEsB,IAArE,GACGhB,IADH,CACQ,iBAAS;AACbR,QAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,CAACgB,KAAD,CAArB;AACD,GAHH,EAGKd,KAHL,CAGW,eAAO;AACd,QAAIC,GAAJ,EAAS;AACP,YAAMA,GAAN;AACD;AACF,GAPH;AAQD,CATD;;AAWAc,OAAOC,OAAP,GAAiBjC,MAAjB","file":"user.js","sourcesContent":["'use strict';\r\n\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst User = require('../models/user');\r\n\r\n\r\n/**\r\n* Route to add new users\r\n* req input: {name:String, email: String, profilePic: String, description:String}\r\n* res output: {_id: String, name:String, email: String, profilePic: String, description:String, __v: Number}\r\n*/\r\nrouter.post('/addUser', (req,res) => {\r\n  User.findOneAndUpdate({profileId: req.body.profileId}, {\r\n    name: req.body.name,\r\n    description: req.body.description,\r\n    profilePic: req.body.profilePic,\r\n  },\r\n  {\r\n    new:true\r\n  }).then(user => {\r\n    res.status(200).json(user);\r\n  }).catch(err => {\r\n    throw err;\r\n  });\r\n});\r\n\r\n/**\r\n* Route to add edit information of existing users\r\n* req input: {name:String, profilePic: String, description:String}\r\n* res output: {_id: String, name:String, profileId: String, profilePic: String, description:String, __v: Number}\r\n*/\r\nrouter.post('/editUser', (req,res) => {\r\n  console.log(req.session.passport.user.profileId);\r\n  User.findOne({profileId: req.session.passport.user.profileId})\r\n    .then(user => {\r\n      if (user) {\r\n        user.name = req.body.name;\r\n        user.description = req.body.description;\r\n        user.profilePic = req.body.profilePic;\r\n        user.save();\r\n        res.status(200).json(user.toObject());\r\n      } else {\r\n        res.status(500).json({error: 'user not found'});\r\n      }\r\n    });\r\n});\r\n\r\n\r\n/**\r\n* Retrieves current user\r\n* res output: {_id: String, name:String, profileId: String, profilePic: String, description:String, __v: Number}\r\n*/\r\nrouter.get('/getUser', (req,res) => {\r\n  User.find({profileId: req.session.passport.user.profileId}).lean()\r\n    .then(user => {\r\n      res.status(200).json(user[0]);\r\n    }).catch(err => {\r\n      if (err) {\r\n        throw err;\r\n      }\r\n    });\r\n});\r\n\r\n/**\r\n* Retrieves all other users other than current user\r\n* res output: {Array of Objs} [{_id: String,\r\n* name:String, profileId: String, profilePic: String, description:String, __v: Number}]\r\n*/\r\n\r\nrouter.get('/getAllUsers', (req,res) => {\r\n  User.find({'profileId': {$ne: req.session.passport.user.profileId}}).lean()\r\n    .then(users => {\r\n      res.status(200).json([users]);\r\n    }).catch(err => {\r\n      if (err) {\r\n        throw err;\r\n      }\r\n    });\r\n});\r\n\r\nmodule.exports = router;\r\n"]}